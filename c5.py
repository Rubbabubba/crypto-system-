(full content from c5.py as provided above)