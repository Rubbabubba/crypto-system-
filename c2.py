(full content from c2.py as provided above)