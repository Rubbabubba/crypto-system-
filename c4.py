(full content from c4.py as provided above)